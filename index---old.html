<!DOCTYPE html>
<html>
<head>
<title>OpenMap</title>
<meta charset="utf-8" />
<meta name="theme-color" content="#369">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="HandheldFriendly" content="true">
<meta name="mobile-web-app-capable" content="yes"> 
<link rel="shortcut icon" type="image/webp" size="144x144" href="./onemap.webp"> 

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script src="./js/geomap.js"></script>
<script src="./js/mini.js"></script>

<style>
n {font-weight: normal;}
em {font-size: 12px;}
button {margin:0.2em;padding:0.2em;min-width: 3em;;}
#map {
	height: 600px;
	width: 100%;
}

/* 4. W≈Çasny styl dla markera z widocznym opisem (tabliczki) */
.custom-marker {
	background-color: white; /* Bia≈Çe t≈Ço 'tabliczki' */
	border-radius: 5px;
	padding: 5px 10px;
	font-weight: bold;
	font-size: 14px;
	white-space: nowrap; /* Zapobiega ≈Çamaniu tekstu */
	box-shadow: 0 2px 5px rgba(0,0,0,0.3);
	border: 2px solid; /* Obramowanie, kolor ustawi siƒô w JS */
	transform: translate(-50%, -100%); /* Przesuniƒôcie, by 'kotwica' by≈Ça na dole */
	position: absolute; /* Umo≈ºliwia pozycjonowanie */
	pointer-events: auto; /* Reaguje na klikniƒôcia */
	text-align: center;
}

/* Styl dla 'szpikulca' wska≈∫nika */
.custom-marker::after {
	content: '';
	position: absolute;
	bottom: -8px;
	left: 50%;
	transform: translateX(-50%);
	width: 0;
	height: 0;
	border-left: 8px solid transparent;
	border-right: 8px solid transparent;
	border-top: 8px solid; /* Kolor ustawi siƒô w JS */
}
/* Nowy styl dla panelu kontrolnego (filtra) */
.filter-control {
    background: white;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 1px 5px rgba(0,0,0,0.4);
    font-family: sans-serif;
}

.filter-control label {
    display: block;
    margin-bottom: 5px;
    font-weight: normal;
    cursor: pointer;
}

.filter-control h4 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 16px;
    border-bottom: 1px solid #ccc;
    padding-bottom: 5px;
}

</style>
</head>
<body>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    
<script>
let markers = [];
let   startLat = 53.17;
const deltaLat =  0.07;
const startLon = 14.2;
const deltaLon =  0.09;
let countFake  =  0;

const punktyURL = "./mesh_nodes.json";
const runRUN=async()=>{
	return await asyncFetchJson(punktyURL); 
}
document.addEventListener("DOMContentLoaded",async (event)=>{ 
	let meshtNODE111 = await runRUN();
	console.log("meshtNODE111=",meshtNODE111);
})


	
const fakePosition=()=>{
    countFake++;
    if (countFake>10) {
        countFake = 1;
        startLat-=deltaLat;
    }
	return [startLat,startLon+okk(deltaLon*countFake)];
}    

// 2. Mapowanie kategorii na kolory
//const pallete=["#FF0000","#00FF00","#FFFF00","#0000FF","#FF00FF","#00FFFF","#000000","#800000","#808000","#008000","#800080","#008080","#000080","#FFA500","#808080","#C0C0C0"];
const pallete=["#FF0000","#008800","#0000FF","#FF00FF","#000000","#800000","#00FFFF","#808000","#008000","#800080","#008080","#000080","#808080","#C0C0C0","#FFA500","#FFFF00"];
//console.log(pallete)

const roles = ["CLIENT","CLIENT_MUTE","ROUTER","ROUTER_CLIENT","REPEATER","TRACKER","SENSOR","TAK","CLIENT_HIDDEN","LOST_AND_FOUND","TAK_TRACKER","ROUTER_LATE","CLIENT_BASE"];
//const rolee = ["CLIENT","CLIENT_MUTE","ROUTER","ROUTER_LATE","CLIENT_BASE"];
//console.log(roles)
            //let str_meshtNODE = localStorage.getItem("meshtNODE");
			//let str_meshtNODE = runRUN();	

let meshtNODE0 ={
	"!e124509a": {
		"hop": 3,
		"hops": 4,
		"timestamp": 1764150133,
		"snr": 6.75,
		"rssi": -62,
		"latitude": 534073344,
		"longitude": 145264640,
		"hops_away": 3,
		"Autil": 0.45,
		"Cutil": 1.7,
		"bat": 95,
		"vol": 4.13,
		"uptime": 566519,
		"shortname": "WSEh",
		"longname": "Andrzej SP1WSE Pomo SZN PL Home",
		"hardware": 63,
		"role": 12
	},
	"!199bc86f": {
		"hop": 2,
		"hops": 7,
		"shortname": "zmoP",
		"longname": "zmo SOLAR Parapet #1 test",
		"timestamp": 1764413593,
		"snr": 10.75,
		"rssi": -75,
		"latitude": 534511616,
		"longitude": 146014208,
		"hops_away": 2,
		"hardware": 88,
		"role": 0
	},
	"!8847aff6": {
		"hop": 2,
		"hops": 7,
		"shortname": "SG-8",
		"longname": "Stocznia Wulkan",
		"timestamp": 1764413098,
		"snr": 11.25,
		"rssi": -57,
		"latitude": 534315008,
		"longitude": 145948672,
		"hops_away": 2,
		"hardware": 88,
		"role": 12
	},
	"!30f963ca": {
		"hop": 4,
		"hops": 7,
		"shortname": "MSBR",
		"longname": "Marek Pogodno Base",
		"timestamp": 1764412459,
		"snr": 11,
		"rssi": -51,
		"hardware": 7,
		"role": 0,
		"latitude": 534372352,
		"longitude": 145072128,
		"hops_away": 4
	},
	"!6c7311bc": {
		"hop": 2,
		"hops": 7,
		"shortname": "Coor",
		"longname": "Coornik mobile SZN",
		"timestamp": 1764407961,
		"snr": -14.25,
		"rssi": -84,
		"latitude": 533661146,
		"longitude": 146470761,
		"hops_away": 2,
		"hardware": 4,
		"role": 1
	},
	"!06d8450c": {
		"hop": 2,
		"hops": 7,
		"shortname": "Mvr2",
		"longname": "Mover 2 Marek",
		"timestamp": 1764359238,
		"snr": -7.75,
		"rssi": -78,
		"hardware": 3,
		"role": 1,
		"Autil": 0.02,
		"Cutil": 0,
		"bat": 96,
		"vol": 4.13,
		"uptime": 12129,
		"hops_away": 2,
		"latitude": 534540288,
		"longitude": 145698816
	},
	"!71c403d9": {
		"hop": 2,
		"hops": 5,
		"shortname": "sebo",
		"longname": "SQ1SK-8",
		"timestamp": 1764054123,
		"snr": 10.5,
		"rssi": -90,
		"latitude": 533451071,
		"longitude": 150646313,
		"hops_away": 2,
		"hardware": 63,
		"role": 0
	},
	"!9e7585dc": {
		"hop": 3,
		"hops": 7,
		"shortname": "85dc",
		"longname": "HF1MM tracker  85dc",
		"timestamp": 1764358137,
		"snr": -13.5,
		"rssi": -84,
		"hardware": 48,
		"role": 1,
		"latitude": 534335191,
		"longitude": 145361180,
		"hops_away": 3,
		"Autil": 0.03,
		"Cutil": 2.23,
		"bat": 101,
		"vol": 4.31,
		"uptime": 12319
	},
	"!b03bda88": {
		"hop": 3,
		"hops": 7,
		"shortname": "Neo",
		"longname": "Krzysiek Neo Mobilny ",
		"timestamp": 1764411633,
		"snr": 10.5,
		"rssi": -50,
		"latitude": 533737472,
		"longitude": 146608128,
		"hops_away": 3,
		"hardware": 43,
		"role": 1,
		"Autil": 0.04,
		"Cutil": 0.86,
		"bat": 38,
		"vol": 3.62,
		"uptime": 49270
	},
	"!0663fc37": {
		"hop": 2,
		"hops": 3,
		"timestamp": 1764412346,
		"snr": -8.75,
		"rssi": -79,
		"latitude": 534766586,
		"longitude": 145841626,
		"hops_away": 2,
		"Autil": 0.05,
		"Cutil": 4.02,
		"bat": 101,
		"vol": 4.42,
		"uptime": 918816,
		"shortname": "fc37",
		"longname": "Meshtastic fc37",
		"hardware": 69,
		"role": 0
	},
	"!433b5650": {
		"hop": 5,
		"hops": 5,
		"shortname": "MZs1",
		"longname": "Marcin ≈ªelechowa MZs1 portable5650",
		"timestamp": 1764338933,
		"snr": 11.5,
		"rssi": -83,
		"latitude": 534609920,
		"longitude": 145719296,
		"hops_away": 5,
		"Autil": 0.02,
		"Cutil": 0.32,
		"bat": 99,
		"vol": 4.18,
		"uptime": 207032,
		"hardware": 43,
		"role": 1
	},
	"!04cde162": {
		"hop": 2,
		"hops": 6,
		"shortname": "PHPn",
		"longname": "Kamil SQ1PHP Node",
		"timestamp": 1764410697,
		"snr": 11,
		"rssi": -52,
		"hardware": 69,
		"role": 1,
		"Autil": 0,
		"Cutil": 0,
		"bat": 31,
		"vol": 3.55,
		"uptime": 1554636,
		"hops_away": 2,
		"latitude": 534413312,
		"longitude": 145653760
	},
	"!433cd500": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764412610,
		"snr": 11,
		"rssi": -78,
		"latitude": 534865697,
		"longitude": 145836109,
		"hops_away": 2,
		"shortname": "d500",
		"longname": "SQ3CPS/1 Szczecin (Heltec, MediumFast)",
		"hardware": 44,
		"role": 0
	},
	"!50ce8bfb": {
		"hop": 6,
		"hops": 6,
		"timestamp": 1764411373,
		"snr": -8.5,
		"rssi": -79,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 6,
		"latitude": 533561344,
		"longitude": 145981440,
		"shortname": "Mre1",
		"longname": "Sailor Podjuchy",
		"hardware": 63,
		"role": 0
	},
	"!b03d6104": {
		"hop": 4,
		"hops": 7,
		"shortname": "KRS",
		"longname": "Krakowska SZN RAKU",
		"timestamp": 1764413073,
		"snr": 11.5,
		"rssi": -57,
		"Autil": 0.66,
		"Cutil": 3.05,
		"bat": 101,
		"vol": 4.24,
		"uptime": 3094947,
		"hops_away": 3,
		"hardware": 43,
		"role": 0,
		"latitude": 534032384,
		"longitude": 144961536
	},
	"!b78f3d38": {
		"hop": 2,
		"hops": 4,
		"shortname": "74V",
		"longname": "Meshtastic 74V",
		"timestamp": 1764411840,
		"snr": 10.75,
		"rssi": -75,
		"Autil": 0.28,
		"Cutil": 3.51,
		"bat": 101,
		"vol": 4.21,
		"uptime": 162024,
		"hops_away": 2,
		"hardware": 71,
		"role": 0,
		"latitude": 534839296,
		"longitude": 145817600
	},
	"!e0d0371c": {
		"hop": 2,
		"hops": 7,
		"shortname": "GG2",
		"longname": "Grzegorz Mobile",
		"timestamp": 1764412993,
		"snr": 8.5,
		"rssi": -58,
		"hardware": 4,
		"role": 1,
		"Autil": 0.01,
		"Cutil": 1.73,
		"bat": 80,
		"vol": 3.96,
		"uptime": 245413,
		"hops_away": 2,
		"latitude": 534511616,
		"longitude": 146014208
	},
	"!9e9fb984": {
		"hop": 2,
		"hops": 3,
		"timestamp": 1764167362,
		"snr": 11,
		"rssi": -58,
		"Autil": 0.4,
		"Cutil": 1.45,
		"bat": 70,
		"vol": 3.9,
		"uptime": 9182,
		"hops_away": 2,
		"shortname": "JUL",
		"longname": "Meshtastic Julka Mobile",
		"hardware": 43,
		"role": 0
	},
	"!db2f6948": {
		"hop": 4,
		"hops": 7,
		"timestamp": 1764413324,
		"snr": 11.25,
		"rssi": -58,
		"latitude": 534777856,
		"longitude": 145215488,
		"hops_away": 4,
		"shortname": "LTOS",
		"longname": "LanTech-Osow-Szczecin",
		"Autil": 0.79,
		"Cutil": 8.23,
		"bat": 96,
		"vol": 4.14,
		"uptime": 1212185,
		"hardware": 44,
		"role": 0
	},
	"!9e04a8b5": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764410184,
		"snr": -10,
		"rssi": -80,
		"latitude": 534642688,
		"longitude": 145358848,
		"hops_away": 3,
		"shortname": "Kl3",
		"longname": "Klorel Mobile",
		"hardware": 69,
		"role": 1
	},
	"!adb6b1f1": {
		"hop": 2,
		"hops": 4,
		"shortname": "POMO",
		"longname": "Pomorzany Node SZN Solarüå§Ô∏è",
		"timestamp": 1764238714,
		"snr": 11.25,
		"rssi": -85,
		"Autil": 1.05,
		"Cutil": 13.7,
		"bat": 69,
		"vol": 3.88,
		"uptime": 1208037,
		"hops_away": 2,
		"hardware": 63,
		"role": 2,
		"latitude": 534028288,
		"longitude": 145268736
	},
	"!7f62d8e4": {
		"hop": 5,
		"hops": 7,
		"shortname": "ZSP1",
		"longname": "Betoniusz Pogodno Szczecin üè°üì°",
		"timestamp": 1764239335,
		"snr": -2.75,
		"rssi": -73,
		"latitude": 534511616,
		"longitude": 144965632,
		"hops_away": 5,
		"hardware": 69,
		"role": 0,
		"Autil": 0.09,
		"Cutil": 0,
		"bat": 76,
		"vol": 3.95,
		"uptime": 2252404
	},
	"!b2a792f0": {
		"hop": 2,
		"hops": 7,
		"shortname": "92f0",
		"longname": "SP1IT solar 5 Lipca 92f0",
		"timestamp": 1764413703,
		"snr": 10.5,
		"rssi": -79,
		"Autil": 0.61,
		"Cutil": 3.13,
		"bat": 59,
		"vol": 3.8,
		"uptime": 7147,
		"hops_away": 2,
		"hardware": 110,
		"role": 12,
		"latitude": 534338238,
		"longitude": 145364364
	},
	"!13baf789": {
		"hop": 3,
		"hops": 6,
		"timestamp": 1764413640,
		"snr": -9.25,
		"rssi": -80,
		"Autil": 0.48,
		"Cutil": 1.93,
		"bat": 101,
		"vol": 4.06,
		"uptime": 46688,
		"hops_away": 3,
		"shortname": "MIDU",
		"longname": "Michal - Dunikowskiego - Solar",
		"hardware": 9,
		"role": 0
	},
	"!40548612": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764408677,
		"snr": 10,
		"rssi": -51,
		"Autil": 0.58,
		"Cutil": 2.48,
		"bat": 92,
		"vol": 4.03,
		"uptime": 183257,
		"hops_away": 2,
		"shortname": "BTPB",
		"longname": "BetoniuszJeszczeNiePogodno",
		"hardware": 95,
		"role": 12,
		"latitude": 534511616,
		"longitude": 147587072
	},
	"!6c73b554": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764412094,
		"snr": 11,
		"rssi": -51,
		"Autil": 0,
		"Cutil": 0,
		"bat": 100,
		"vol": 4.16,
		"uptime": 331687,
		"hops_away": 3,
		"shortname": "BTNP",
		"longname": "Betoniusz Portable MF üìüüáµüá±",
		"hardware": 4,
		"role": 1,
		"latitude": 534642688,
		"longitude": 147718144
	},
	"!4358e664": {
		"hop": 3,
		"hops": 5,
		"shortname": "US",
		"longname": "Meshtastic US",
		"timestamp": 1764413328,
		"rssi": -76,
		"latitude": 534357400,
		"longitude": 145327400,
		"hops_away": 3,
		"Autil": 0.53,
		"Cutil": 0.58,
		"bat": 101,
		"vol": 4.23,
		"uptime": 5699448,
		"hardware": 43,
		"role": 11,
		"snr": 11
	},
	"!849c3370": {
		"hop": 5,
		"hops": 7,
		"timestamp": 1764239141,
		"snr": 10.75,
		"rssi": -68,
		"latitude": 534224896,
		"longitude": 144957440,
		"hops_away": 4,
		"Autil": 0.01,
		"Cutil": 2.28,
		"bat": 101,
		"vol": 4.3,
		"uptime": 61,
		"shortname": "SDXh",
		"longname": "Robert SQ1SDX Home",
		"hardware": 43,
		"role": 1
	},
	"!849c3e1c": {
		"hop": 3,
		"hops": 7,
		"shortname": "GUMI",
		"longname": "SQ1SDX Router Gumie≈Ñce SZN",
		"timestamp": 1764238607,
		"snr": 11,
		"rssi": -76,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 3,
		"hardware": 43,
		"role": 2,
		"latitude": 534228992,
		"longitude": 144953344
	},
	"!5fd3e078": {
		"hop": 4,
		"hops": 7,
		"timestamp": 1764386145,
		"snr": 10.5,
		"rssi": -44,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 4,
		"shortname": "GGrT",
		"longname": "GGrT",
		"hardware": 37,
		"role": 0,
		"latitude": 534511616,
		"longitude": 146014208
	},
	"!b03d73a0": {
		"hop": 2,
		"hops": 7,
		"shortname": "RAKU",
		"longname": "Piotr RAKU SZN Mobile ",
		"timestamp": 1764412654,
		"snr": 11,
		"rssi": -52,
		"hardware": 43,
		"role": 1,
		"latitude": 534502443,
		"longitude": 145691799,
		"hops_away": 2
	},
	"!6982c588": {
		"hop": 2,
		"hops": 3,
		"shortname": "ZSPO",
		"longname": "Adam SP1ZS Solar Pomorzany",
		"timestamp": 1764411845,
		"snr": 11,
		"rssi": -52,
		"hardware": 110,
		"role": 12
	},
	"!433baff4": {
		"hop": 5,
		"hops": 7,
		"shortname": "BOBO",
		"longname": "szara kaczka ü¶Ü",
		"timestamp": 1764238681,
		"snr": 10.5,
		"rssi": -73,
		"hardware": 48,
		"role": 0,
		"Autil": 0.32,
		"Cutil": 0.46,
		"bat": 101,
		"vol": 4.22,
		"uptime": 294188,
		"hops_away": 5,
		"latitude": 535458323,
		"longitude": 145593531
	},
	"!abdd2e8a": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764412715,
		"snr": 10.5,
		"rssi": -76,
		"Autil": 0.33,
		"Cutil": 0.9,
		"bat": 66,
		"vol": 3.86,
		"uptime": 699952,
		"hops_away": 3,
		"shortname": "PSR1",
		"longname": "Pawel Dobra Remote Karpaty ‚òÄ",
		"latitude": 534634496,
		"longitude": 143892480,
		"hardware": 88,
		"role": 0
	},
	"!a2ed55c8": {
		"hop": 2,
		"hops": 7,
		"shortname": "Mvr1",
		"longname": "Mover1",
		"timestamp": 1764412007,
		"snr": -8.5,
		"rssi": -79,
		"latitude": 534541001,
		"longitude": 145698597,
		"hops_away": 2,
		"hardware": 50,
		"role": 1,
		"Autil": 0,
		"Cutil": 7.43,
		"bat": 101,
		"vol": 4.81,
		"uptime": 133988
	},
	"!ecb61bd7": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764411933,
		"snr": 11,
		"rssi": -52,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 2,
		"latitude": 534643490,
		"longitude": 145444000,
		"shortname": "Kl4",
		"longname": "Kl - Szn/Solar/Test",
		"hardware": 9,
		"role": 0
	},
	"!433bf188": {
		"hop": 5,
		"hops": 7,
		"timestamp": 1764326201,
		"snr": 10.75,
		"rssi": -50,
		"latitude": 533889024,
		"longitude": 144801792,
		"hops_away": 5,
		"shortname": "BHKp",
		"longname": "BHK PAPIER portable",
		"hardware": 49,
		"role": 1,
		"Autil": 0.03,
		"Cutil": 1.13,
		"bat": 59,
		"vol": 3.8,
		"uptime": 62585
	},
	"!eb9c211e": {
		"hop": 2,
		"hops": 7,
		"shortname": "MZs2",
		"longname": "Marcin ≈ªelechowa FakeTec MZs2",
		"timestamp": 1764413291,
		"snr": 10.75,
		"rssi": -76,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 2,
		"hardware": 63,
		"role": 12,
		"latitude": 534626304,
		"longitude": 145702912
	},
	"!6982c568": {
		"hop": 2,
		"hops": 7,
		"shortname": "PSBS",
		"longname": "Pawel Dobra 135¬∞",
		"timestamp": 1764410861,
		"snr": -11.5,
		"rssi": -81,
		"hardware": 110,
		"role": 12,
		"latitude": 534851584,
		"longitude": 143929344,
		"hops_away": 2
	},
	"!698285b8": {
		"hop": 3,
		"hops": 7,
		"shortname": "LSR",
		"longname": "Wojtek LSR Warszewo",
		"timestamp": 1764412931,
		"snr": 10.25,
		"rssi": -77,
		"latitude": 534511616,
		"longitude": 145489920,
		"hops_away": 3,
		"Autil": 0.02,
		"Cutil": 5.72,
		"bat": 101,
		"vol": 4.31,
		"uptime": 67,
		"hardware": 110,
		"role": 12
	},
	"!e43de310": {
		"hop": 2,
		"hops": 7,
		"shortname": "AZ-5",
		"longname": "AZ-5 solar test node",
		"timestamp": 1764413548,
		"snr": -5,
		"rssi": -75,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 3.67,
		"hops_away": 2,
		"latitude": 534380544,
		"longitude": 145620992,
		"hardware": 63,
		"role": 1
	},
	"!3e530afe": {
		"hop": 3,
		"hops": 7,
		"shortname": "WSE",
		"longname": "Andrzej SP1WSE Pomo SZN PL mobile üìü",
		"timestamp": 1764400168,
		"snr": 11.25,
		"rssi": -80,
		"hardware": 63,
		"role": 1,
		"latitude": 534073344,
		"longitude": 145264640,
		"hops_away": 5
	},
	"!bc3cdfbf": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764410688,
		"snr": 10,
		"rssi": -53,
		"Autil": 0.57,
		"Cutil": 0,
		"bat": 75,
		"vol": 3.94,
		"uptime": 680152,
		"hops_away": 3,
		"shortname": "PSR2",
		"longname": "Pawel Dobra Remote Arkonska ‚òÄ",
		"hardware": 88,
		"role": 0
	},
	"!12b119b4": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764412817,
		"snr": 11,
		"rssi": -51,
		"latitude": 534839296,
		"longitude": 145162240,
		"hops_away": 2,
		"shortname": "LTNS",
		"longname": "LanTech-Niebuszewo-Szczecin",
		"Autil": 0.93,
		"Cutil": 1.74,
		"bat": 101,
		"vol": 4.28,
		"uptime": 300956,
		"hardware": 3,
		"role": 0
	},
	"!b7d72a6e": {
		"hop": 2,
		"hops": 7,
		"shortname": "KLB0",
		"longname": "Betoniusz Kliniska üè°üì° üìµ",
		"timestamp": 1764413059,
		"snr": 11,
		"rssi": -58,
		"latitude": 534642688,
		"longitude": 147718144,
		"hops_away": 2,
		"hardware": 9,
		"role": 0,
		"Autil": 0.04,
		"Cutil": 4.45,
		"bat": 101,
		"vol": 4.28,
		"uptime": 3040318
	},
	"!13270344": {
		"hop": 3,
		"hops": 7,
		"shortname": "iBot",
		"longname": "Szczecin SzamBu≈õ InfoBOT [PM] !help",
		"timestamp": 1764411395,
		"snr": -7.25,
		"rssi": -77,
		"hardware": 81,
		"role": 2,
		"latitude": 534749200,
		"longitude": 145891300,
		"hops_away": 2
	},
	"!e7736325": {
		"hop": 4,
		"hops": 7,
		"shortname": "CntR",
		"longname": "Central Relay",
		"timestamp": 1764411648,
		"snr": 11,
		"rssi": -78,
		"hardware": 30,
		"role": 12,
		"latitude": 534240140,
		"longitude": 145362380,
		"hops_away": 4,
		"Autil": 0.02,
		"Cutil": 2.13,
		"bat": 101,
		"vol": 0,
		"uptime": 65
	},
	"!58657bad": {
		"hop": 3,
		"hops": 4,
		"timestamp": 1764412919,
		"snr": 11,
		"rssi": -57,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 3,
		"shortname": "NoMi",
		"longname": "Nowe Miasto",
		"latitude": 534159360,
		"longitude": 145383424,
		"hardware": 63,
		"role": 12
	},
	"!a2e95154": {
		"hop": 2,
		"hops": 7,
		"shortname": "TAOm",
		"longname": "MeshTAOnode¬Æ T-Deck mobile",
		"timestamp": 1764238601,
		"snr": 10.5,
		"rssi": -89,
		"hardware": 50,
		"role": 1
	},
	"!849b5fec": {
		"hop": 4,
		"hops": 7,
		"shortname": "SmSm",
		"longname": "Quaczek ( Simosolominer )",
		"timestamp": 1764413260,
		"snr": 10.75,
		"rssi": -76,
		"hardware": 43,
		"role": 12,
		"latitude": 534511616,
		"longitude": 144965632,
		"hops_away": 3
	},
	"!082bc919": {
		"hop": 4,
		"hops": 6,
		"shortname": "RaV1",
		"longname": "RaV Mobile üì±",
		"timestamp": 1764413307,
		"snr": 11,
		"rssi": -77,
		"Autil": 0,
		"Cutil": 0.33,
		"bat": 101,
		"vol": 4.98,
		"uptime": 479428,
		"hops_away": 4,
		"hardware": 7,
		"role": 1,
		"latitude": 534806528,
		"longitude": 145522688
	},
	"!433d56a4": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764332631,
		"snr": 11.75,
		"rssi": -53,
		"latitude": 534529750,
		"longitude": 145680510,
		"hops_away": 2,
		"Autil": 0.01,
		"Cutil": 6.27,
		"bat": 101,
		"vol": 4.38,
		"uptime": 62,
		"shortname": "KP",
		"longname": "Komuny Paryskiej",
		"hardware": 43,
		"role": 12
	},
	"!1de8d0bc": {
		"hop": 2,
		"hops": 2,
		"shortname": "BKO3",
		"longname": "Szczecin Bukowo üì° S3 -> Przesocin",
		"timestamp": 1764410943,
		"snr": 12,
		"rssi": -51,
		"hardware": 81,
		"role": 2,
		"latitude": 534749200,
		"longitude": 145891300,
		"hops_away": 2
	},
	"!c07c59b7": {
		"hop": 0,
		"hops": 7,
		"shortname": "MAJO",
		"longname": "Majowy 59b7",
		"timestamp": 1764408982,
		"snr": 10.5,
		"rssi": -42,
		"Autil": 0.05,
		"Cutil": 6.92,
		"bat": 86,
		"vol": 4.03,
		"uptime": 65,
		"hops_away": 0,
		"hardware": 88,
		"role": 0,
		"latitude": 533823488,
		"longitude": 146702336
	},
	"!844f9084": {
		"hop": 3,
		"hops": 4,
		"timestamp": 1764402914,
		"snr": 11.25,
		"rssi": -50,
		"Autil": 0.01,
		"Cutil": 9.53,
		"bat": 7,
		"vol": 3.24,
		"hops_away": 4,
		"shortname": "Cat",
		"longname": "Catüêõ",
		"hardware": 7,
		"role": 1,
		"latitude": 534183936,
		"longitude": 145293312,
		"uptime": 993690
	},
	"!71a38879": {
		"hop": 4,
		"hops": 7,
		"shortname": "PRZO",
		"longname": "Przesocin OMNI",
		"timestamp": 1764413416,
		"snr": -5.5,
		"rssi": -76,
		"Autil": 0.66,
		"Cutil": 1.81,
		"bat": 73,
		"vol": 3.92,
		"uptime": 216802,
		"hops_away": 4,
		"hardware": 88,
		"role": 11,
		"latitude": 535035904,
		"longitude": 145489920
	},
	"!77817b21": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764411269,
		"snr": -6,
		"rssi": -76,
		"latitude": 535095120,
		"longitude": 145720580,
		"hops_away": 2,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"shortname": "PRZ1",
		"longname": "Przesocin S1 345",
		"hardware": 63,
		"role": 2
	},
	"!6984955c": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764239302,
		"snr": 11,
		"rssi": -73,
		"latitude": 533954560,
		"longitude": 146636800,
		"hops_away": 3,
		"shortname": "KSsz",
		"longname": "Krzysztof SZN DƒÖbie",
		"hardware": 110,
		"role": 1
	},
	"!a0cbc2b0": {
		"hop": 5,
		"hops": 5,
		"timestamp": 1764412908,
		"snr": 11.5,
		"rssi": -57,
		"latitude": 534159360,
		"longitude": 145383424,
		"hops_away": 5,
		"Autil": 0.58,
		"Cutil": 0.29,
		"bat": 48,
		"vol": 3.71,
		"uptime": 747637,
		"shortname": "AleU",
		"longname": "Ale Urwa≈Ç - Kuso - Nowe Miasto",
		"hardware": 49,
		"role": 0
	},
	"!d08bbe40": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764411903,
		"snr": 10.5,
		"rssi": -51,
		"Autil": 0,
		"Cutil": 2.56,
		"bat": 101,
		"vol": 0,
		"uptime": 155963,
		"hops_away": 2,
		"shortname": "be40",
		"longname": "Budka Dla Ptak√≥w 2",
		"hardware": 88,
		"role": 1
	},
	"!9716edbc": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764410969,
		"snr": 11.5,
		"rssi": -51,
		"latitude": 533640100,
		"longitude": 146005800,
		"hops_away": 2,
		"shortname": "MSI",
		"longname": "MSI",
		"hardware": 81,
		"role": 2,
		"Autil": 0.22,
		"Cutil": 2.07,
		"bat": 101,
		"vol": 0,
		"uptime": 489778
	},
	"!4ed36e3c": {
		"hop": 4,
		"hops": 7,
		"timestamp": 1764238349,
		"snr": 10.5,
		"rssi": -73,
		"latitude": 533415726,
		"longitude": 144718281,
		"hops_away": 4,
		"Autil": 0.08,
		"Cutil": 4.21,
		"bat": 41,
		"vol": 3.64,
		"uptime": 2087,
		"shortname": "mhm",
		"longname": "mhm",
		"hardware": 50,
		"role": 0
	},
	"!ba6a59bc": {
		"hop": 0,
		"hops": 5,
		"shortname": "MARU",
		"longname": "Majowy kursorüß≠",
		"timestamp": 1764411771,
		"hardware": 48,
		"role": 1,
		"Autil": 0.01,
		"Cutil": 2.13,
		"bat": 37,
		"vol": 3.6,
		"uptime": 99059,
		"hops_away": 0,
		"snr": "?",
		"rssi": "?"
	},
	"!9e76b860": {
		"hop": 3,
		"hops": 3,
		"shortname": "BULI",
		"longname": "Buli Mobile",
		"timestamp": 1764340107,
		"snr": 10.75,
		"rssi": -52,
		"Autil": 0,
		"Cutil": 1.6,
		"bat": 41,
		"vol": 3.65,
		"uptime": 25927,
		"hops_away": 2,
		"hardware": 43,
		"role": 1
	},
	"!db295878": {
		"hop": 5,
		"hops": 7,
		"timestamp": 1764329313,
		"snr": 7.5,
		"rssi": -61,
		"latitude": 535363584,
		"longitude": 145555456,
		"hops_away": 5,
		"shortname": "BG_H",
		"longname": "BG92 Home",
		"hardware": 43,
		"role": 0,
		"Autil": 0.04,
		"Cutil": 0.9,
		"bat": 101,
		"vol": 4.27,
		"uptime": 681017
	},
	"!71a5ad7b": {
		"hop": 0,
		"hops": 6,
		"shortname": "Zoro",
		"longname": "ZnakZorro",
		"timestamp": 1764411490,
		"snr": 11,
		"rssi": -80,
		"Autil": 0.45,
		"Cutil": 1.02,
		"bat": 101,
		"vol": 0,
		"uptime": 102132,
		"hops_away": 0,
		"hardware": 88,
		"role": 0
	},
	"!ae614b4c": {
		"hop": 2,
		"hops": 7,
		"shortname": "zmoH",
		"longname": "zmo[h] Szczecin Bukowo home üè°üì°",
		"timestamp": 1764413643,
		"snr": 10.25,
		"rssi": -80,
		"hardware": 81,
		"role": 1,
		"latitude": 534749200,
		"longitude": 145891300,
		"hops_away": 2
	},
	"!0b9beb3b": {
		"hop": 3,
		"hops": 3,
		"timestamp": 1764413723,
		"snr": 11.25,
		"rssi": -80,
		"shortname": "Potu",
		"longname": " Potulicka Solar",
		"hardware": 9,
		"role": 0,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 3,
		"latitude": 534167552,
		"longitude": 145440768
	},
	"!e06b3440": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764412619,
		"snr": 11,
		"rssi": -51,
		"latitude": 534342055,
		"longitude": 145363388,
		"hops_away": 3,
		"shortname": "3440",
		"longname": "SP1IT Tomek T114 3440",
		"hardware": 69,
		"role": 1
	},
	"!9ea1b8d8": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764413386,
		"snr": 8.75,
		"rssi": -58,
		"shortname": "zmoD",
		"longname": "zmo[D] Szczecin DƒÖbie omni üè°üì°",
		"hardware": 43,
		"role": 0,
		"Autil": 0.37,
		"Cutil": 3.96,
		"bat": 101,
		"vol": 4.78,
		"uptime": 1024023,
		"hops_away": 2,
		"latitude": 533987328,
		"longitude": 146538496
	},
	"!74fd4ef7": {
		"hop": 2,
		"hops": 5,
		"timestamp": 1764411033,
		"snr": -9.25,
		"rssi": -79,
		"shortname": "PHPw",
		"longname": "Warszewo SZN SOLAR",
		"hardware": 69,
		"role": 12,
		"Autil": 0.11,
		"Cutil": 7.5,
		"bat": 93,
		"vol": 4.1,
		"uptime": 595296,
		"hops_away": 2,
		"latitude": 534675456,
		"longitude": 145588224
	},
	"!970f5880": {
		"hop": 6,
		"hops": 7,
		"timestamp": 1764330720,
		"snr": 4.75,
		"rssi": -65,
		"latitude": 535453696,
		"longitude": 145580032,
		"hops_away": 6,
		"shortname": "HZPL",
		"longname": "HUB Police FYQ 5880 üåêüîåüìµ",
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hardware": 81,
		"role": 12
	},
	"!ae608a98": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764412842,
		"snr": 11.25,
		"rssi": -60,
		"shortname": "BKO1",
		"longname": "Szczecin Bukowo üì° S1 -> Zdunowo",
		"hardware": 81,
		"role": 2,
		"latitude": 534749200,
		"longitude": 145891300,
		"hops_away": 2
	},
	"!2490ddbd": {
		"hop": 3,
		"hops": 3,
		"timestamp": 1764406346,
		"snr": 10,
		"rssi": -52,
		"shortname": "q3a2",
		"longname": "Jakub Portale",
		"hardware": 63,
		"role": 1,
		"latitude": 534151168,
		"longitude": 145391616,
		"hops_away": 3
	},
	"!b03cfdd4": {
		"hop": 1,
		"hops": 7,
		"timestamp": 1764404611,
		"snr": 10.75,
		"rssi": -59,
		"shortname": "DDR",
		"longname": "Drzetowo Dworzec SZN RAKU",
		"hardware": 43,
		"role": 2,
		"latitude": 534501730,
		"longitude": 145691380,
		"hops_away": 2
	},
	"!b03d0d00": {
		"hop": 2,
		"hops": 5,
		"timestamp": 1764371509,
		"snr": 11.25,
		"rssi": -52,
		"shortname": "BUKO",
		"longname": "Osiedle Bukowe SZN solar ‚òÄÔ∏è",
		"hardware": 43,
		"role": 2,
		"latitude": 533658270,
		"longitude": 146474360,
		"hops_away": 2
	},
	"!ea8f9e6c": {
		"hop": 2,
		"hops": 3,
		"timestamp": 1764412898,
		"snr": 8.75,
		"rssi": -58,
		"latitude": 534511616,
		"longitude": 144965632,
		"hops_away": 2,
		"shortname": "MNet",
		"longname": "MarioNetka Zawadzkiego",
		"hardware": 81,
		"role": 0,
		"Autil": 0.61,
		"Cutil": 0,
		"bat": 101,
		"vol": 0,
		"uptime": 1204332
	},
	"!a377e95a": {
		"hop": 4,
		"hops": 7,
		"timestamp": 1764331786,
		"snr": 10.5,
		"rssi": -85,
		"latitude": 535381799,
		"longitude": 145432400,
		"hops_away": 4,
		"shortname": "ZPL1",
		"longname": "Police Meshtastic 01 Solar üìµüåû",
		"Autil": 0.35,
		"Cutil": 1.73,
		"bat": 100,
		"vol": 4.29,
		"uptime": 378234,
		"hardware": 9,
		"role": 0
	},
	"!cfa84487": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764412542,
		"snr": 11.25,
		"rssi": -79,
		"Autil": 0,
		"Cutil": 1.8,
		"bat": 92,
		"vol": 4.08,
		"uptime": 156741,
		"hops_away": 2,
		"shortname": "4487",
		"longname": "Lampa Solarna ",
		"hardware": 88,
		"role": 1
	},
	"!5d89af76": {
		"hop": 5,
		"hops": 7,
		"timestamp": 1764159021,
		"snr": 10.5,
		"rssi": -60,
		"shortname": "af76",
		"longname": "Meshtastic af76",
		"hardware": 9,
		"role": 1,
		"latitude": 534753280,
		"longitude": 145887232,
		"hops_away": 2
	},
	"!b6887473": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764412698,
		"snr": -6.25,
		"rssi": -76,
		"Autil": 0.01,
		"Cutil": 0.97,
		"bat": 62,
		"vol": 3.9,
		"hops_away": 3,
		"shortname": "PSCO",
		"longname": "Pawel Dobra Carry On",
		"hardware": 71,
		"role": 1,
		"latitude": 534851584,
		"longitude": 143929344,
		"uptime": 8169
	},
	"!b03d9820": {
		"hop": 0,
		"hops": 6,
		"timestamp": 1764408511,
		"snr": 11,
		"rssi": -50,
		"shortname": "MAIO",
		"longname": "MAJOWO 9820",
		"hardware": 43,
		"role": 0,
		"Autil": 0.58,
		"Cutil": 2.75,
		"bat": 93,
		"vol": 4.1,
		"uptime": 88321,
		"hops_away": 0,
		"latitude": 533757952,
		"longitude": 146702336
	},
	"!c0c30a44": {
		"hop": 5,
		"hops": 5,
		"timestamp": 1764401746,
		"snr": 10.5,
		"rssi": -79,
		"Autil": 0.11,
		"Cutil": 0,
		"bat": 5,
		"vol": 3.48,
		"uptime": 511303,
		"hops_away": 5,
		"shortname": "BHKt",
		"longname": "SQ1BHK Olek T-Beam Tracker",
		"hardware": 4,
		"role": 5
	},
	"!ae614da4": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764396744,
		"snr": 11,
		"rssi": -51,
		"shortname": "PRZ2",
		"longname": "Przesocin S2 -> Dobra 256'",
		"hardware": 81,
		"role": 11,
		"Autil": 0.76,
		"Cutil": 2.87,
		"bat": 101,
		"vol": 0,
		"uptime": 143544,
		"hops_away": 2
	},
	"!1de7f57c": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764413702,
		"snr": 10.5,
		"rssi": -79,
		"latitude": 534749200,
		"longitude": 145891300,
		"hops_away": 2,
		"shortname": "BKO2",
		"longname": "Szczecin Bukowo üì° S2 -> Wiskord",
		"hardware": 81,
		"role": 2,
		"Autil": 0.05,
		"Cutil": 16.79,
		"bat": 2,
		"vol": 3.14,
		"uptime": 66
	},
	"!a0cbb6ec": {
		"hop": 3,
		"hops": 3,
		"timestamp": 1764325072,
		"snr": 10.5,
		"rssi": -78,
		"shortname": "MISS",
		"longname": "Misiek Mobile Stick",
		"hardware": 44,
		"role": 0,
		"latitude": 534511616,
		"longitude": 146014208,
		"hops_away": 3
	},
	"!96b723f3": {
		"hop": 4,
		"hops": 7,
		"timestamp": 1764413669,
		"snr": 11.25,
		"rssi": -50,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 4,
		"latitude": 536487916,
		"longitude": 145078866,
		"shortname": "BHQp",
		"longname": "Piotrek SQ1BHQ 23f3 üìü",
		"hardware": 71,
		"role": 1
	},
	"!bba83e44": {
		"hop": 3,
		"hops": 5,
		"timestamp": 1764413241,
		"snr": 10.5,
		"rssi": -43,
		"shortname": "RaV0",
		"longname": "RaV Szczecin P√≥≈Çnoc üì°üìµ",
		"hardware": 4,
		"role": 12,
		"latitude": 534806528,
		"longitude": 145522688,
		"hops_away": 3,
		"Autil": 0.17,
		"Cutil": 9.04,
		"bat": 101,
		"vol": 0,
		"uptime": 758546
	},
	"!023e71b0": {
		"hop": 2,
		"hops": 3,
		"timestamp": 1764404444,
		"snr": 7.5,
		"rssi": -60,
		"shortname": "MI26",
		"longname": "Michal - 26 kwietnia",
		"hardware": 9,
		"role": 2,
		"Autil": 1.07,
		"Cutil": 1.87,
		"bat": 85,
		"vol": 4.02,
		"uptime": 993745,
		"hops_away": 3
	},
	"!da740f38": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764076296,
		"snr": 10.5,
		"rssi": -84,
		"shortname": "FYQH",
		"longname": "Brama Portowa 0f38 üåêüîåüìµ",
		"hardware": 81,
		"role": 0,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 4.16,
		"hops_away": 3,
		"latitude": 534249707,
		"longitude": 145504160
	},
	"!8a3edc0f": {
		"hop": 3,
		"hops": 4,
		"timestamp": 1764412440,
		"snr": -10.75,
		"rssi": -81,
		"latitude": 534183936,
		"longitude": 145424384,
		"hops_away": 3,
		"shortname": "q3a",
		"longname": "Jakub Ruchomy",
		"hardware": 69,
		"role": 1
	},
	"!acaa8988": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764228508,
		"snr": 9.5,
		"rssi": -55,
		"shortname": "8988",
		"longname": "3Z1P Niebuszewo",
		"hardware": 43,
		"role": 1,
		"latitude": 534249472,
		"longitude": 145227776,
		"hops_away": 2
	},
	"!a6962518": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764413702,
		"snr": 10.75,
		"rssi": -79,
		"shortname": "ZS/P",
		"longname": "SP1ZS TRACKER",
		"hardware": 110,
		"role": 1,
		"latitude": 534038825,
		"longitude": 145221280,
		"hops_away": 3
	},
	"!5c86bc83": {
		"hop": 6,
		"hops": 7,
		"timestamp": 1764376139,
		"snr": 11,
		"rssi": -50,
		"Autil": 0.01,
		"Cutil": 1.2,
		"bat": 61,
		"vol": 3.82,
		"uptime": 65,
		"hops_away": 4,
		"shortname": "CATX",
		"longname": "SP1CAT_Xiaotorola",
		"hardware": 88,
		"role": 1
	},
	"!49a7e0ef": {
		"hop": 3,
		"hops": 5,
		"timestamp": 1764412928,
		"snr": 10.75,
		"rssi": -56,
		"shortname": "TRB",
		"longname": "Trzebie≈º Meshtastic solar üìµüåû",
		"hardware": 9,
		"role": 2
	},
	"!2308edd2": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764410138,
		"snr": -12.25,
		"rssi": -82,
		"shortname": "EarN",
		"longname": "EarNest",
		"hardware": 69,
		"role": 2,
		"latitude": 533463040,
		"longitude": 146014208,
		"hops_away": 2
	},
	"!a3e96a08": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764396068,
		"snr": 11,
		"rssi": -49,
		"shortname": "MIBE",
		"longname": "Michal - Bezrzecze",
		"hardware": 9,
		"role": 2,
		"Autil": 0.78,
		"Cutil": 4.15,
		"bat": 101,
		"vol": 4.31,
		"uptime": 43267,
		"hops_away": 3,
		"latitude": 534511616,
		"longitude": 144441344
	},
	"!db2ab64c": {
		"hop": 6,
		"hops": 7,
		"timestamp": 1764234051,
		"snr": 3.75,
		"rssi": -65,
		"shortname": "BG_M",
		"longname": "BG92 Mobile ",
		"hardware": 43,
		"role": 1
	},
	"!e6b63b83": {
		"hop": 3,
		"hops": 3,
		"timestamp": 1764316529,
		"snr": -10.75,
		"rssi": -81,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 3,
		"shortname": "Mila",
		"longname": "Milan3b83",
		"hardware": 7,
		"role": 1
	},
	"!c90db810": {
		"hop": 7,
		"hops": 7,
		"timestamp": 1764318908,
		"snr": 10.25,
		"rssi": -55,
		"Autil": 0,
		"Cutil": 0,
		"bat": 0,
		"vol": 0,
		"hops_away": 7,
		"shortname": "xxx",
		"longname": "xxx xxx xxx"
	},
	"!a0cb84b0": {
		"hop": 5,
		"hops": 7,
		"timestamp": 1764362148,
		"snr": 11,
		"rssi": -79,
		"latitude": 534511616,
		"longitude": 144965632,
		"hops_away": 5,
		"shortname": "SmHT",
		"longname": "SimoTracker Biegatchek",
		"hardware": 48,
		"role": 1
	},
	"!06c87028": {
		"hop": 6,
		"hops": 7,
		"timestamp": 1764235931,
		"snr": 10.75,
		"rssi": -55,
		"latitude": 534069248,
		"longitude": 145276928,
		"hops_away": 4,
		"shortname": "BBS",
		"longname": "BBS Mesh Szczecin v0.28 Testy",
		"hardware": 3,
		"role": 12
	},
	"!90a10318": {
		"hop": 6,
		"hops": 7,
		"timestamp": 1764403102,
		"snr": 10.5,
		"rssi": -50,
		"shortname": "BTMP",
		"longname": "Betoniusz MQTT Pogodnoüì°",
		"hardware": 81,
		"role": 0
	},
	"!ab6a491f": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764166201,
		"snr": 7.75,
		"rssi": -60,
		"Autil": 0.02,
		"Cutil": 4.89,
		"bat": 101,
		"vol": 4.21,
		"uptime": 2768,
		"hops_away": 2,
		"shortname": "xxx",
		"longname": "xxx xxx xxx"
	},
	"!a81f487f": {
		"hop": 3,
		"hops": 3,
		"timestamp": 1764413002,
		"snr": 11.25,
		"rssi": -57,
		"latitude": 534032384,
		"longitude": 145264640,
		"hops_away": 3,
		"shortname": "WSR",
		"longname": "Andrzej SP1WSR Portable Mini FakeTec v5",
		"Autil": 0.01,
		"Cutil": 2.47,
		"bat": 65,
		"vol": 3.85,
		"hardware": 63,
		"role": 1,
		"uptime": 39731
	},
	"!b03d0324": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764410802,
		"snr": 9.75,
		"rssi": -52,
		"shortname": "MZs0",
		"longname": "Marcin ≈ªelechowa MZs0",
		"hardware": 43,
		"role": 0,
		"Autil": 0.46,
		"Cutil": 8.02,
		"bat": 93,
		"vol": 4.09,
		"uptime": 47445,
		"hops_away": 3,
		"latitude": 534609920,
		"longitude": 145719296
	},
	"!c652ac12": {
		"hop": 3,
		"hops": 4,
		"timestamp": 1764403534,
		"snr": 11.5,
		"rssi": -57,
		"shortname": "ac12",
		"longname": "Andrzej Szczecin üáµüá± PL",
		"hardware": 71,
		"role": 1
	},
	"!186fba4c": {
		"hop": 6,
		"hops": 7,
		"timestamp": 1764413334,
		"snr": 11.25,
		"rssi": -58,
		"shortname": "BHQp",
		"longname": "Piotrek SQ1BHQ ba4c V2",
		"hardware": 5,
		"role": 1,
		"latitude": 537416100,
		"longitude": 145005800,
		"hops_away": 6,
		"Autil": 0.01,
		"Cutil": 2.4,
		"bat": 101,
		"vol": 0,
		"uptime": 61
	},
	"!172e462f": {
		"hop": 4,
		"hops": 7,
		"timestamp": 1764395279,
		"snr": 7.5,
		"rssi": -43,
		"shortname": "BHQr",
		"longname": "Piotrek zch nrf52",
		"hardware": 63,
		"role": 1
	},
	"!331fa555": {
		"hop": 4,
		"hops": 7,
		"timestamp": 1764270796,
		"snr": 10,
		"rssi": -90,
		"shortname": "xxx",
		"longname": "xxx xxx xxx"
	},
	"!849aced4": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764413660,
		"snr": 10.5,
		"rssi": -79,
		"latitude": 534511616,
		"longitude": 145489920,
		"hops_away": 2,
		"shortname": "TAOh",
		"longname": "MeshTAOnode¬Æ Wi-Fi heltec node CED4",
		"hardware": 43,
		"role": 1,
		"Autil": 0.1,
		"Cutil": 5.57,
		"bat": 45,
		"vol": 3.68,
		"uptime": 42008
	},
	"!69851184": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764413646,
		"snr": 11,
		"rssi": -43,
		"latitude": 533987328,
		"longitude": 146538496,
		"hops_away": 2,
		"shortname": "KG14",
		"longname": "krzysztof SZN DƒÖbie",
		"hardware": 110,
		"role": 1
	},
	"!977f4369": {
		"hop": 2,
		"hops": 7,
		"timestamp": 1764413582,
		"snr": 10.5,
		"rssi": -51,
		"Autil": 0.01,
		"Cutil": 0,
		"bat": 95,
		"vol": 4.13,
		"uptime": 146960,
		"hops_away": 2,
		"shortname": "SSR",
		"longname": "S≈Çoneczne SZN RAKU",
		"hardware": 88,
		"role": 0,
		"latitude": 533987328,
		"longitude": 146538496
	},
	"!ea067cc0": {
		"hop": 3,
		"hops": 3,
		"timestamp": 1764413563,
		"snr": 11.25,
		"rssi": -58,
		"latitude": 534511616,
		"longitude": 145489920,
		"hops_away": 3,
		"Autil": 0.31,
		"Cutil": 0,
		"bat": 101,
		"vol": 4.97,
		"uptime": 256586,
		"shortname": "7cc0",
		"longname": "ab84_T-DECK",
		"hardware": 50,
		"role": 0
	},
	"!43b6b45c": {
		"hop": 6,
		"hops": 7,
		"timestamp": 1764356442,
		"snr": 10.75,
		"rssi": -65,
		"shortname": "b45c",
		"longname": "Meshtastic b45c",
		"hardware": 43,
		"role": 1
	},
	"!be50bab5": {
		"hop": 3,
		"hops": 7,
		"timestamp": 1764366948,
		"snr": 10.75,
		"rssi": -54,
		"latitude": 0,
		"longitude": 0,
		"hops_away": 3,
		"shortname": "BAB5",
		"longname": "MT BAB5 SZN PL",
		"hardware": 255,
		"role": 12
	},
	"!9009c49b": {
		"hop": 5,
		"hops": 7,
		"timestamp": 1764374949,
		"snr": 11.25,
		"rssi": -50,
		"shortname": "xxx",
		"longname": "xxx xxx xxx"
	},
	"!ea8f96b8": {
		"hop": 3,
		"hops": 6,
		"timestamp": 1764340104,
		"snr": 11,
		"rssi": -52,
		"latitude": 533987328,
		"longitude": 145489920,
		"hops_away": 3,
		"shortname": "xxx",
		"longname": "xxx xxx xxx"
	},
	"!26fa8c49": {
		"hop": 4,
		"hops": 5,
		"timestamp": 1764339944,
		"snr": 10.5,
		"rssi": -81,
		"shortname": "xxx",
		"longname": "xxx xxx xxx"
	},
	"!06c85ff0": {
		"hop": 3,
		"hops": 4,
		"timestamp": 1764371349,
		"snr": 10,
		"rssi": -53,
		"shortname": "WSRH",
		"longname": "Andrzej SP1WSR Home Pomorzany SZN TLORA",
		"hardware": 3,
		"role": 1,
		"Autil": 0.01,
		"Cutil": 6.8,
		"bat": 91,
		"vol": 4.06,
		"uptime": 61,
		"hops_away": 3
	},
	"!433d19bc": {
		"hop": 3,
		"hops": 3,
		"timestamp": 1764411771,
		"snr": -9.5,
		"rssi": -80,
		"Autil": 0.26,
		"Cutil": 0,
		"bat": 100,
		"vol": 4.2,
		"uptime": 590211,
		"hops_away": 3,
		"latitude": 533987328,
		"longitude": 144965632,
		"shortname": "xxx",
		"longname": "xxx xxx xxx"
	},
	"!43598d4c": {
		"hop": 3,
		"hops": 3,
		"timestamp": 1764397571,
		"snr": 11,
		"rssi": -49,
		"latitude": 533987328,
		"longitude": 144965632,
		"hops_away": 3,
		"Autil": 0.24,
		"Cutil": 0,
		"bat": 101,
		"vol": 4.23,
		"uptime": 154639,
		"shortname": "xxx",
		"longname": "xxx xxx xxx"
	}
}











	
            //let meshtNODE0 = JSON.parse(str_meshtNODE);
            console.log(0,Object.keys(meshtNODE0).length);
            let meshtNODE = {}
                    for (id in meshtNODE0){
                        let nod = meshtNODE0[id];
                        //console.log(0,id,nod.shortname, nod.latitude,nod.latitude,nod.role)
                                //if (nod.latitude  === undefined) {delete meshtNODE0[id];  continue;}
                                //if (nod.longitude === undefined) {delete meshtNODE0[id];  continue;}
                                if (nod.latitude===undefined || nod.longitude===undefined || nod.latitude===0 || nod.longitude===0) {
                                    //delete meshtNODE0[id];  continue;
                                    let geo = fakePosition();
                                    nod.latitude  = geo[0]*10000000;
                                    nod.longitude = geo[1]*10000000;
                                    //console.log("fakePosition=",geo)
                                    //console.log("nod====",nod)
                                }
                                

                        // {delete meshtNODE0[id];  continue;}
                        //if (nod.shortname === "xxx") {delete meshtNODE0[id];  continue;}
                        meshtNODE[id] = nod;
                    }
                    //console.log(1,Object.keys(meshtNODE).length);
                    for (id in meshtNODE){
                        let nod = meshtNODE[id];
                        //console.log(1,id,nod.shortname, nod.latitude,nod.latitude,nod.role)
                    }
            let kategorie=[];
            let objKat = {};
            let arrKat=[];
            for (let id in meshtNODE){
                let role = meshtNODE[id].role;
                //if (role===2) console.log("2 ROUTER=",id,meshtNODE[id].shortname)
                //if (role===5) console.log("5 tracker=",id,meshtNODE[id].shortname)
                //if (role===11) console.log("11 ROUTER_LATE=",id,meshtNODE[id].shortname,role)
                if (role!="undefine" && role!=null) {
                    //kategorie.push(role)
                    if (!objKat[role]) objKat[role]=0;
                    objKat[role]++;
                }
            }
            console.log(objKat);
            //arrKat = Object.keys(objKat);

            for(let v in objKat){
                
                let c = objKat[v]
                arrKat.push(c)
                let name = roles[parseInt(v)];
                kategorie.push(name);//+"-"+c)
            }
            console.log(JSON.stringify( kategorie))
            //kategorie = [...new Set(kategorie)].sort((a,b)=>a-b);
            //kategorie.forEach((v,i)=>{kategorie[i]=roles[parseInt(v)]})
            console.log(kategorie)



    const kategoriaKolor = {};
    kategorie.forEach((key,c)=>{
        let val = pallete[c];
        kategoriaKolor[key]=val;
    });
    kategoriaKolor["Inne"]="#000040";

    //console.log(kategoriaKolor)
// 3. Inicjalizacja mapy
const map = L.map('map').setView([52.0, 19.0], 6);

// 4. Dodanie warstwy OpenStreetMap
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);


// ***********************************************
// NOWE KROKI DLA FILTRA: Grupy Warstw
// ***********************************************

// 5. Inicjalizacja Grup Warstw (Layer Groups) dla ka≈ºdej kategorii
const kategorieGrupy = {};
Object.keys(kategoriaKolor).forEach(kategoria => {
    // Ka≈ºda grupa jest domy≈õlnie dodawana do mapy (czyli jest widoczna)
    //console.log(0,kategoria)
    //qqqqqqqqqqqqqqqqqqqqqqqqqq
    kategorieGrupy[kategoria] = L.layerGroup().addTo(map);
});
// Upewnienie siƒô, ≈ºe grupa 'Inne' istnieje
if (!kategorieGrupy["Inne"]) {kategorieGrupy["Inne"] = L.layerGroup().addTo(map);}


// 6. Funkcja do tworzenia markera z widocznym opisem (tabliczka)
function utworzCustomMarker(dane) {
    //console.log(dane)
    const kategoria = dane.kategoria;
    //console.log("kategoria=",kategoria,dane.role)
    const kolor = kategoriaKolor[kategoria] || kategoriaKolor["Inne"];
    
    // Okre≈õlenie, do kt√≥rej grupy warstw nale≈ºy ten marker
    const grupa = kategorieGrupy[kategoria] || kategorieGrupy["Inne"];

    // Tworzenie elementu DIV dla markera (widoczna 'tabliczka')
    const iconDiv = document.createElement('div');
    iconDiv.className = 'custom-marker';
    iconDiv.style.borderColor = dane.txcolor;
    iconDiv.style.backgroundColor = dane.bgcolor;
    iconDiv.style.color = dane.txcolor;
    iconDiv.textContent = dane.opis;

    // Ustawienie koloru "szpikulca" (dla CSS)
    const styleSheet = document.createElement("style");
    styleSheet.innerHTML = `.custom-marker[data-color="${kolor}"]::after { border-top-color: ${kolor}; }`;
    document.head.appendChild(styleSheet);
    iconDiv.setAttribute('data-color', kolor);

    // Utworzenie niestandardowej ikony Leaflet
    const customIcon = L.divIcon({
        html: iconDiv,
        className: 'custom-icon',
        iconSize: [0, 0],
        iconAnchor: [0, 0]
    });
    
    // Utworzenie markera i dodanie go do ODPOWIEDNIEJ GRUPY
    const marker = L.marker([dane.lat, dane.lon], { 
        icon: customIcon,
        iconAnchor: [0, 0],
        draggable: true 
    }).addTo(grupa); // <--- Zmiana: dodajemy do grupy, nie bezpo≈õrednio do mapy
    markers.push(marker)
    

    // Dodanie okna pop-up po klikniƒôciu
    const popupContent = `
        <div style="font-family: sans-serif;">
            <h4 style="margin: 0 0 5px; color: ${kolor};">${dane.opis} <n>[${dane.km}km]</n></h4>
            <p style="margin: 0; font-size: 14px;">${dane.szczegolowy_opis}</p>
            <em>Role: <b>${dane.kategoria}</b>, hop:${dane.hop}<br />${dane.id}</em>
        </div>
    `;

    marker.bindPopup(popupContent, {
        offset: L.point(0, -30)
    });

    // ***********************************************
    // NOWY KROK: Obs≈Çuga zdarzenia po zako≈Ñczeniu przesuwania
    // ***********************************************
    marker.on('moveend', function(e) {
        const newLatLng = marker.getLatLng();
        //console.log(`Punkt "${dane.opis}" przesuniƒôto do: Lat ${newLatLng.lat.toFixed(6)}, Lng ${newLatLng.lng.toFixed(6)}`);
        
        // Aktualizacja tre≈õci pop-upu z nowymi wsp√≥≈Çrzƒôdnymi (opcjonalnie)
        marker.setPopupContent(popupContent + 
            `<hr style="margin: 5px 0;">
            <p style="margin: 0; font-size: 12px; color: #555;">Nowa pozycja:<br>
            Lat: ${newLatLng.lat.toFixed(6)}<br>
            Lng: ${newLatLng.lng.toFixed(6)}</p>
        `).openPopup();
    });    


    return marker;
}

// 7. Przetwarzanie danych JSON i dodawanie marker√≥w do grup
/*daneJson.forEach(dane => {
    utworzCustomMarker(dane);
});*/


// ***********************************************
// NOWE KROKI DLA FILTRA: Niestandardowy Kontroler
// ***********************************************

// 8. Utworzenie niestandardowego kontrolera dla filtra
const FilterControl = L.Control.extend({
    options: {
        position: 'topright' // Umie≈õƒá kontroler w prawym g√≥rnym rogu
    },

    onAdd: function (map) {
        // Utworzenie g≈Ç√≥wnego kontenera DIV
        const container = L.DomUtil.create('div', 'filter-control leaflet-bar');
        
        // Zbudowanie HTML dla listy checkbox√≥w
        let htmlContent = `<h4>Node: <span id="licznik">${Object.keys(meshtNODE).length}</span></h4>`;
        
        Object.keys(kategorieGrupy).forEach((kategoria,i) => {
            const id = 'filter-' + kategoria.toLowerCase();
            const kolor = kategoriaKolor[kategoria] || kategoriaKolor["Inne"];

            htmlContent += `
                <label for="${id}" style="color: ${kolor};" title="${kategoria}-${arrKat[i]}" data-cnt="${arrKat[i]}">
                    <input type="checkbox" id="${id}" checked data-kategoria="${kategoria}" data-cnt="${arrKat[i]}">
                    ${kategoria}
                </label>
            `;
        });
        htmlContent += "<button onclick='showOrNot(false)'>Nic</button>";
        htmlContent += "<button onclick='showOrNot(true)'>Wszystko</button>";
        
        container.innerHTML = htmlContent;

        // Zapobieganie zdarzeniom mapy (przesuniƒôcie, powiƒôkszenie) na kontrolerze
        L.DomEvent.disableClickPropagation(container);
        L.DomEvent.disableScrollPropagation(container);

        // 9. Dodanie logiki obs≈Çugi zdarze≈Ñ
        container.addEventListener('change', (e) => {
            if (e.target.type === 'checkbox') {
                const kategoria = e.target.getAttribute('data-kategoria');
                const grupa = kategorieGrupy[kategoria];
                //console.log(e.target.checked,grupa)
                if (e.target.checked) {
                    // W≈ÇƒÖcz checkbox: dodaj grupƒô do mapy
                    map.addLayer(grupa);
                } else {
                    // Wy≈ÇƒÖcz checkbox: usu≈Ñ grupƒô z mapy
                    map.removeLayer(grupa);
                }
            }
            policzWidocznePunkty();
        });

        return container;
    }
});

// 10. Dodanie kontrolera filtra do mapy
new FilterControl().addTo(map);


const showOrNot=(flag=true)=>{
    let aless = document.querySelectorAll('input[type=checkbox]');

    [...aless].forEach((input,i)=>{
        input.checked = flag;        
        const kategoria = input.getAttribute('data-kategoria');
        //console.log(i,kategoria);
        const grupa = kategorieGrupy[kategoria];
        //console.log(i,grupa);
        if (flag) map.addLayer(grupa);
        else      map.removeLayer(grupa);
    });
}


/*
// Opcjonalnie: Dopasowanie widoku mapy do wszystkich marker√≥w
if (daneJson.length > 0) {
    const bounds = L.latLngBounds(daneJson.map(p => [p.lat, p.lon]));
    map.fitBounds(bounds, { padding: [50, 50] });
}
*/
/*
const kategoriaKolor = {
    "Historia": "#E74C3C", // Czerwony
    "Zabytki": "#3498DB", // Niebieski
    "Zakupy": "#27AE60", // Zielony
    "Inne": "#F39C12"    // Pomara≈Ñczowy
};
*/
const convert2Dat=(meshtNODE)=>{


    let arr = [];
    let notRole={}
    for (id in meshtNODE){
        let nod = meshtNODE[id];
        //if (!nod.latitude)  {delete meshtNODE[id]; continue;}
        //if (!nod.longitude) {delete meshtNODE[id]; continue;}
        
        //console.log(id,nod);
        let obj = {}
        obj.id=id;
        let bgcolor = "#"+id.slice(-6);
        let txcolor = checkBrightness(bgcolor);
        let txcstyl = styleBrightness(bgcolor);
        obj.bgcolor = bgcolor;
        obj.txcolor = txcolor;
        obj.lat = parseInt(nod.latitude   || 0)/10000000;
        obj.lon = parseInt(nod.longitude  || 0)/10000000;
                            let geo=[];
                            geo[0] = obj.lat;
                            geo[1] = obj.lon;
                            
                            let km = ok(geoKM(geo));
                            obj.km = km;
        obj.opis = nod.shortname;
        obj.kategoria = roles[nod.role] || "Inne";
                if (!roles[nod.role]) {
                    //console.log("---",id,nod.shortname,"role=",roles[nod.role],nod)
                    notRole[id] = nod.shortname
                }
        obj.role =nod.role;
        obj.hop  = nod.hop+"/"+nod.hops;
        obj.szczegolowy_opis = nod.longname;
        obj.info = `<span>Hop:${nod.hop}, Role:${roles[nod.role]}</span>`;
        //if (nod.shortname==="Mila") continue;
        //if (nod.shortname==="BG_M") continue;
        //console.log(bgcolor,txcolor)
        arr.push(obj)
    }
    console.log("notRole=",notRole)
    return arr;
}


const hexToRgb=(hex) =>{
        let result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
            r: parseInt(result[1], 16),
            g: parseInt(result[2], 16),
            b: parseInt(result[3], 16)
        } : null;
    }    
    const checkBrightness=(hex)=>{
        if (hex==="#?") return "#006"
        let color = hexToRgb(hex);
        if (!color) return "#000"
        const brightness = Math.round(((parseInt(color.r) * 299) +   (parseInt(color.g) * 587) + (parseInt(color.b) * 114)) / 1000)
        if(brightness < 150){return("rgb(255,255,255)")} 
        else {return("rgb(0,0,0)")}
    }   
    const styleBrightness=(hex)=>{
        if (hex==="#?") return "#006"
        let color = hexToRgb(hex);
        if (!color) return "#000"
        const brightness = Math.round(((parseInt(color.r) * 299) +   (parseInt(color.g) * 587) + (parseInt(color.b) * 114)) / 1000)
        if(brightness < 150){return("white")} 
        else {return("black")}
    }   
  




const mapaMAPA=(daneJson)=>{
    // 6. Przetwarzanie danych JSON i dodawanie marker√≥w
    daneJson.forEach(dane => {
        utworzCustomMarker(dane);
    });

    // Opcjonalnie: Dopasowanie widoku mapy do wszystkich marker√≥w
    if (daneJson.length > 0) {
        const bounds = L.latLngBounds(daneJson.map(p => [p.lat, p.lon]));
        map.fitBounds(bounds, { padding: [50, 50] });
    } 
}



document.addEventListener("DOMContentLoaded",function(){
            
            let nodeJson = convert2Dat(meshtNODE);
            //console.log(nodeJson);
            
            //console.log(daneJson)
            mapaMAPA(nodeJson);
            let aless = document.querySelectorAll("div.filter-control label");
            console.log(aless);
            [...aless].forEach((c)=>{
                //console.log(c.dataset.cnt);
                //let inp = c.querySelector("input");
                //console.log(c.dataset.cnt,"==", c.textContent);
                //let tx = c.textContent.trim();
                //if (c.dataset.cnt!="undefined") c.textContent = tx+": "+ c.dataset.cnt;
            })
		});
    </script>










<script>
console.log("***********************************************=")
console.log("kategorieGrupy=",kategorieGrupy)
console.log("markers=",markers)

// ***********************************************
// NOWA FUNKCJA: Liczenie widocznych punkt√≥w
// ***********************************************

function policzWidocznePunkty() {
    // 1. Pobranie aktualnych granic widocznego obszaru mapy
    const bounds = map.getBounds();
    console.log(bounds)
    let licznik = 0;
    const widocznePunkty = [];
    
    // Lista wszystkich grup, kt√≥re sƒÖ AKTYWNE na mapie
    const aktywneGrupy = Object.values(kategorieGrupy).filter(grupa => map.hasLayer(grupa));
    //console.log(aktywneGrupy.length)
    // 2. Iteracja przez aktywne grupy marker√≥w
    aktywneGrupy.forEach((grupa,i) => {
        // Iteracja przez markery wewnƒÖtrz danej grupy
        //console.log(i,grupa)
        grupa.eachLayer(marker => {
            //console.log(marker)
            // 3. Pobranie wsp√≥≈Çrzƒôdnych markera
            const latlng = marker.getLatLng();

            // 4. Sprawdzenie, czy marker znajduje siƒô w granicach
            if (bounds.contains(latlng)) {
                licznik++;
                // Zak≈Çadamy, ≈ºe oryginalne dane (opis) sƒÖ przechowywane w opcjach markera
                // W Leaflet nie ma to automatycznie, musimy to dodaƒá.
                // Poniewa≈º dane oryginalne sƒÖ w zmiennej 'daneJson', u≈ºyjemy uproszczonej logiki
                // zak≈ÇadajƒÖcej, ≈ºe marker ma atrybut 'opis'
                //console.log(marker.options.icon.options.html)
                //const opis = marker.options.icon.options.html.match(/<div.*?>(.*?)<\/div>/)[1];
                const opis = marker.options.icon.options.html.textContent //match(/<div.*?>(.*?)<\/div>/)//[1];
                //?????????????????????????????????????????????????????/
                //console.log("000000000000000000=",opis)
                widocznePunkty.push(opis);
            }
        });
    });

    // Wy≈õwietlenie wyniku
    const wynik = `Na mapie widoczne sƒÖ ${licznik} punkty.`;
    const szczegoly = licznik > 0 ? `Widoczne punkty: ${widocznePunkty.join(', ')}` : '';
    $("#licznik").textContent = licznik
    //alert(`${wynik}\n${szczegoly}`);
    
    console.log(wynik);
    console.log(szczegoly);
}

// ***********************************************
// NOWY KONTROLER: Przycisk LiczƒÖcy
// ***********************************************
const CountControl = L.Control.extend({
    options: {
        position: 'topright' // Umie≈õƒá obok filtra
    },

    onAdd: function (map) {
        const button = L.DomUtil.create('button', 'leaflet-bar count-button');
        button.innerHTML = 'Policz Widoczne Punkty';
        button.style.cursor = 'pointer';
        button.style.padding = '5px 10px';
        button.style.backgroundColor = '#f4f4f4';
        button.style.border = '1px solid #ccc';
        button.style.borderRadius = '3px';
        button.style.marginTop = '10px'; // Odstƒôp od filtra

        // PowiƒÖzanie zdarzenia klikniƒôcia z funkcjƒÖ liczƒÖcƒÖ
        L.DomEvent.on(button, 'click', L.DomEvent.stopPropagation)
                  .on(button, 'click', L.DomEvent.preventDefault)
                  .on(button, 'click', policzWidocznePunkty);
        
        return button;
    }
});

// Dodanie kontrolera przycisku do mapy
new CountControl().addTo(map);

document.addEventListener("DOMContentLoaded",(event)=>{ 
    //policzWidocznePunkty()
});

</script>
</body>
</html>
